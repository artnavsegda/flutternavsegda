import 'dart:convert';
import 'dart:core';
import 'package:geolocator/geolocator.dart';
import 'package:flutter/material.dart';
import 'package:yandex_mapkit/yandex_mapkit.dart';
import 'package:http/http.dart' as http;
import 'dart:async';
import 'dart:io';

String greenPoly =
    "POLYGON ((30.140335703324819 59.855673231563131, 30.140248662511826 59.854570147958817, 30.140012628118487 59.854224729045, 30.136761790792505 59.85243820813858, 30.134985219715261 59.851449650600244, 30.134096934176664 59.850971553969806, 30.133380310014964 59.850471859234183, 30.133324768415875 59.849390675201391, 30.13306348151286 59.847379354505755, 30.131680614750188 59.847390358471465, 30.13016784886598 59.847536112558707, 30.130296594898869 59.84537132871106, 30.130328781406696 59.843746298381468, 30.13037169675157 59.84188902339843, 30.130403883259831 59.8412789074827, 30.130082018177561 59.840787567033665, 30.129384643833873 59.8397400697069, 30.128515608113215 59.838449550719155, 30.128043539326409 59.837763773354915, 30.127421266834659 59.836764780955953, 30.127297885219924 59.83628822398228, 30.127313978474056 59.835368841205671, 30.127217418949531 59.83348679467057, 30.137581474583527 59.83336798185659, 30.138042814534202 59.83144531509447, 30.138128645222423 59.83012206681056, 30.138300306599266 59.827524025904317, 30.138364679615634 59.825568609458578, 30.140334556671018 59.825355243991034, 30.144711921784094 59.824874471719646, 30.149561355682728 59.82467729907669, 30.157361219497794 59.824374785305167, 30.164345691772844 59.824156001316119, 30.170703418348548 59.823885864469851, 30.176293141935361 59.823529321593753, 30.184023268316565 59.823429380875851, 30.191301450662344 59.823028825208688, 30.195657358102807 59.822899170340513, 30.199964985780039 59.822891066895245, 30.20620380394881 59.823342155693666, 30.212244138650654 59.823806743746829, 30.217935786180579 59.824049839546632, 30.220698461465751 59.824001220537511, 30.229968175821192 59.825454358211076, 30.241555318765489 59.8279661376671, 30.259601221017764 59.832238427005244, 30.269837262511832 59.83441013589195, 30.2736781858213 59.834658554436061, 30.277616976814436 59.834294601413895, 30.280985831337048 59.83360333764638, 30.282852648811787 59.832912059454181, 30.284676550941271 59.831983131710722, 30.286521910744028 59.830568087169141, 30.288517474251197 59.828623652742358, 30.289547442512596 59.827727014066475, 30.292294024544276 59.825922860435256, 30.297508238868986 59.823232652884748, 30.301563738899386 59.821255373424655, 30.308237074928371 59.817927227363072, 30.314502715187274 59.814922964970854, 30.319459437446742 59.812415602713386, 30.323042868690564 59.811269934543617, 30.326583042495287 59.810491268646381, 30.331437840812381 59.810085942561017, 30.336137071006483 59.81026969100521, 30.340278401725584 59.810820930248447, 30.343539967887743 59.811869340411107, 30.348625436179873 59.813620219691096, 30.353324666374153 59.81472257781698, 30.357272878043844 59.815144058029134, 30.359633221976708 59.815111636673869, 30.3627231267621 59.815111636674025, 30.367207780235169 59.814906300641468, 30.371307350796172 59.815135664950212, 30.377530075710734 59.815643595651935, 30.386971451443124 59.816724273436982, 30.394782044094189 59.817502339672174, 30.401841618221226 59.818291193781327, 30.408622242611198 59.819479842637733, 30.417849041622198 59.8215976933508, 30.424556145333096 59.82310906108259, 30.43090761628088 59.824605453985505, 30.434555420540967 59.825707447513018, 30.43729127373626 59.827047076657685, 30.444629797600392 59.832399651970391, 30.446807751320737 59.833982034153394, 30.449425587319425 59.835958555739317, 30.4518073889247 59.83788636092865, 30.453628201912586 59.83957131169614, 30.455183883141082 59.841444914278853, 30.456685920189567 59.843712533801565, 30.457951922844764 59.84567767869828, 30.459518332908928 59.8471892493971, 30.461556811760385 59.848420048953791, 30.46427657170155 59.849389001551025, 30.468112130592967 59.85054145149946, 30.472350020836746 59.851701957824325, 30.474460919331509 59.85230783395189, 30.478181143235208 59.853280721015189, 30.479785104226195 59.853564080846631, 30.4822098211755 59.853779972395841, 30.490256448219853 59.853995862539676, 30.491370612621989 59.856938796470736, 30.491026180495254 59.857529386279516, 30.489830902904593 59.8591656967189, 30.488099952172224 59.860498894300008, 30.48495640320677 59.862732836560475, 30.481727023552768 59.864896487361726, 30.479463239144074 59.866525876783626, 30.475971003006933 59.867511834302476, 30.477371116112991 59.870267234471079, 30.478181143234877 59.87255715779019, 30.478578110169288 59.873603618946795, 30.47905554337445 59.875103129387348, 30.479463239144355 59.876381435422537, 30.479889063437671 59.87748536489206, 30.480665983827134 59.878173982881542, 30.482183193904696 59.878965056988335, 30.484230561142358 59.87987842042866, 30.486193618593759 59.880749137191664, 30.487226720083797 59.881336466031264, 30.487961414163728 59.881993399359281, 30.488448473278734 59.882666497361669, 30.488678040328342 59.883339581704675, 30.488934702208685 59.884505805063242, 30.489608183997621 59.884568065116667, 30.489934460263619 59.8849837644962, 30.494191016961686 59.885437701486147, 30.49538247613949 59.890860044076156, 30.497191536384033 59.899041244360895, 30.499317730940326 59.90753464186313, 30.50103808715205 59.915961214315111, 30.509114982065181 59.95324975668764, 30.50220328853867 59.964704971255394, 30.501028480989998 59.965355849007679, 30.500508132441105 59.965194475572858, 30.496731582148207 59.9640164254785, 30.494210305673764 59.9632498634532, 30.492407361462877 59.962680071071439, 30.490733163284673 59.962067231791536, 30.489177482055823 59.96196232870691, 30.479993598388653 59.959347712962014, 30.466963630934 59.955896297800848, 30.463787895460644 59.958812477636229, 30.458552223463521 59.96390172440703, 30.457543712873338 59.965289564666371, 30.457414966841061 59.966838712793461, 30.45767245890681 59.970055114592739, 30.45795140864421 59.975852451962766, 30.458316189070409 59.980541204361373, 30.458530555807634 59.983319483375375, 30.458766380217011 59.986086777003294, 30.458787837889652 59.986710355082394, 30.458412328627269 59.987479060112079, 30.457803548274374 59.987937911497525, 30.456913054881866 59.988488887670059, 30.456204951701086 59.988797967841833, 30.452095807490675 59.989340866881086, 30.443641484675627 59.990157886188832, 30.436206401286334 59.991168382072985, 30.4334920057633 59.991770364913791, 30.438019574579791 59.996306382164896, 30.436552781308187 60.002123617892074, 30.435659230647744 60.005290583610204, 30.434693635402382 60.009523915876834, 30.434006989894367 60.011984156101306, 30.433492005763348 60.013348489645544, 30.432462037501772 60.016227370298829, 30.432014189749058 60.02099932109558, 30.431839765010253 60.025753812091736, 30.432114916213841 60.029534213869056, 30.432312480274465 60.033540236706408, 30.432470707321453 60.036177073085717, 30.432528443606476 60.038788121833306, 30.4325907835341 60.041031176823836, 30.432419122157459 60.04154638247639, 30.431986964705445 60.041985415102488, 30.42850210534727 60.042923487027004, 30.424116023760149 60.043866898529672, 30.416606593815239 60.045429516268953, 30.364681658584665 60.055806386583505, 30.340883552794882 60.060641381818243, 30.343769757837368 60.064133026962743, 30.345218152417083 60.066004660825342, 30.348047579588211 60.069484865782044, 30.34921009168664 60.070878989381065, 30.350377997804209 60.072313266383553, 30.351712863555502 60.073957953889916, 30.349922266218627 60.074321720780119, 30.347187531308446 60.074886531011579, 30.343156870759952 60.07570889120251, 30.339821601947225 60.0763862556223, 30.3352861026975 60.077277494879091, 30.3351949075912 60.077006770511034, 30.335060797140159 60.076746765800777, 30.334744296476856 60.076317887566553, 30.333971820280649 60.075738893060887, 30.333263717100756 60.075406502718096, 30.332196197912587 60.075127721137747, 30.331021390363457 60.07492399462636, 30.330250136430113 60.074853978879489, 30.329316727692834 60.074856659505357, 30.328635446602771 60.074119479178165, 30.327519647653151 60.073304540621386, 30.325384609277016 60.072339455652184, 30.324569217736215 60.072162520332455, 30.323070412270773 60.072034602722205, 30.321432131936618 60.072113110676469, 30.31981607906226 60.072313818313923, 30.319449935588842 60.071667375748156, 30.318803479330526 60.070653274383325, 30.317266077655407 60.0686955945425, 30.315187545384696 60.066147394864522, 30.308510017367897 60.067460583334416, 30.30645544526244 60.067691168195537, 30.304121923419455 60.067541020091447, 30.301980690159592 60.067103603066407, 30.2999896606046 60.066537477895352, 30.28390816102597 60.062008938652518, 30.292438210177867 60.045591383139794, 30.293697377460784 60.043518178012448, 30.262932242033663 60.035596194164796, 30.252965647356458 60.032659957104514, 30.232173426982996 60.026561068900783, 30.22056456245679 60.021814543860934, 30.216446852287561 60.019985697454715, 30.213015787626166 60.017641177798851, 30.198974211242817 60.008700984872227, 30.190214068898079 60.00369158984045, 30.187977058877483 59.99842349621315, 30.184275515032652 59.988572831232979, 30.187085787023808 59.981890633247779, 30.200380656031289 59.97932061027673, 30.206929526321545 59.978546338179711, 30.210192800433759 59.969363631672167, 30.215779846756764 59.9613619367342, 30.210984614097175 59.958762848816832, 30.207165677149419 59.952746133597714, 30.204165769771567 59.947556030200595, 30.2037917338601 59.945786163503733, 30.204030543599195 59.944226981289226, 30.205304053730188 59.94214192597709, 30.208997858500137 59.93816522833685, 30.21065821203754 59.935573250317418, 30.211522650094352 59.931788702340477, 30.211876643007592 59.928208838001986, 30.212008090327323 59.92443177311673, 30.210891450078577 59.919203450582458, 30.214813121071863 59.91775237555705, 30.226055657762043 59.9160998711768, 30.236913770541516 59.914794118405744, 30.235068941426494 59.9113763268566, 30.223225367791184 59.902211551185793, 30.206840687179756 59.890336422118352, 30.202634860930697 59.887695221193596, 30.196583674879331 59.887145909559642, 30.186798731365485 59.885831577505812, 30.178858902625915 59.883612582982437, 30.166712880095748 59.87979974601943, 30.15862488048889 59.876282579652383, 30.150163280584021 59.868032057856908, 30.146313393899849 59.865345263154445, 30.142680605700782 59.864363287861423, 30.1403310302146 59.863187037413553, 30.140370043975309 59.8610826320043, 30.140371119708725 59.857781720977989, 30.140335703324819 59.855673231563131))";

String redPoly =
    "POLYGON ((30.076744157623928 59.866825443442956, 30.066673373031573 59.851580677466323, 30.071823214340171 59.829162148375126, 30.078485670452583 59.826589126366748, 30.100458326702572 59.818399145285319, 30.109341802959907 59.815027484369011, 30.116208258038075 59.812779520283968, 30.122044744854481 59.810834043925979, 30.130928221111795 59.807591330121724, 30.14461821592381 59.802748288234177, 30.150969686871086 59.800499493106692, 30.158152936663893 59.799533104565107, 30.162144063678074 59.799533104565107, 30.167808889117513 59.800484564126904, 30.172100423541352 59.801825210912234, 30.1754049050477 59.804333372548143, 30.178108571734708 59.80679810557568, 30.182056783404629 59.809003238055659, 30.185833333697605 59.810062514356517, 30.194073079791341 59.811229840954987, 30.20334279414681 59.813564371096078, 30.21081006404431 59.8166768227443, 30.214972852435416 59.814364126105673, 30.217376111712767 59.81470996014194, 30.24093663569959 59.8210424092253, 30.246172307696661 59.822598321118505, 30.247908354892015 59.82232893459949, 30.253873587741136 59.816580295024686, 30.258508444918867 59.818136415994161, 30.262434518261113 59.819880533199324, 30.275309121532583 59.813158785412725, 30.281016862316282 59.814066625021646, 30.289155817910416 59.811062480706966, 30.311965323373055 59.805279459789489, 30.316032940608395 59.804673864477309, 30.319015064197075 59.804224656805715, 30.322168849162725 59.804164630141912, 30.327275775127088 59.804521380940528, 30.334657214336119 59.804888938372457, 30.343411944560692 59.797061248713689, 30.382757376469133 59.802204068165608, 30.388636778629778 59.8029608523882, 30.393572043217194 59.80425815667266, 30.40391211274218 59.798787252236579, 30.4130101657207 59.802636257229572, 30.42039160492968 59.80609565656362, 30.42622809174609 59.807781983155287, 30.418460414438979 59.811997425244073, 30.447986171274895 59.819778374547084, 30.470173404246069 59.822458057265358, 30.493684497201965 59.822903378160071, 30.522566523874332 59.826403881227044, 30.537844386423153 59.842043594757037, 30.531288354116992 59.845180225959353, 30.520302025992009 59.85027617968133, 30.539528100210752 59.8602930603591, 30.548640660979387 59.874232027491828, 30.546020096647613 59.887481472150533, 30.559115417885923 59.9036926762557, 30.569741304182219 59.92533784744851, 30.577466066145117 59.945495465045944, 30.580641801618704 59.95419217769264, 30.583645875715394 59.962542311021018, 30.578839357160739 59.964521929886608, 30.566823060774052 59.965124399035041, 30.551631028913704 59.96852384028341, 30.544850404524063 59.973084565938677, 30.536782319807273 59.976053001586777, 30.520731981062141 59.980483647915918, 30.509230668806321 59.982075094091378, 30.50142007615495 59.982892293373567, 30.498930986189176 59.985859846863185, 30.499960954450906 59.988526116503536, 30.501677568220419 59.992138138038712, 30.49558358933859 59.996910559789882, 30.495411927961722 60.001295419520943, 30.497986848616019 60.004605172456515, 30.454310972859524 60.03405452140008, 30.490102575288205 60.0538763108788, 30.498513982758912 60.060742375737242, 30.497795000216019 60.064757459497251, 30.49234475149774 60.068339680561735, 30.482520278104879 60.071328964711228, 30.453477247808181 60.076915768503071, 30.436053618047477 60.080003510779314, 30.422749861333617 60.082061844468029, 30.397086485479125 60.084720334681542, 30.384555204961547 60.087164240767081, 30.370435969118482 60.091263709922842, 30.357733027223958 60.09374999465463, 30.344515101198571 60.094693018943417, 30.331983820680993 60.094864474996029, 30.318937556032552 60.0954645641316, 30.304861323122381 60.096921877813429, 30.289583460573557 60.0989791517472, 30.276365534548169 60.099150585424191, 30.262289301638024 60.097521929357363, 30.250241939415158 60.093941839789586, 30.240972225059689 60.089826531881386, 30.230672542442495 60.086739712583373, 30.218938816629908 60.084239502198287, 30.209123742053709 60.083632510341936, 30.1996519902314 60.082339430506408, 30.190432432893346 60.079997022151623, 30.181778016703625 60.075912150868334, 30.172193946287003 60.068598859791756, 30.16229551980927 60.0634936493816, 30.149193460554976 60.059546305212265, 30.125049278569822 60.056285260017859, 30.12490763093103 60.051078148534081, 30.128001067633445 60.043366222865956, 30.104153504972029 60.03068571205376, 30.09722896015014 60.025461831973779, 30.0968290679186 60.021112487557112, 30.102775147008511 60.007899762773214, 30.115307429945986 60.007771152875506, 30.126007133257655 60.005880732678023, 30.129276500520451 59.99995025125537, 30.131639453234207 59.996126702677053, 30.131712933212413 59.987360186775611, 30.156718974818286 59.981693478109833, 30.178774743239543 59.979843930974852, 30.171709595476166 59.946369503128174, 30.180723267082616 59.935260720070005, 30.194236564748206 59.909152631800566, 30.168939389632207 59.893293552651826, 30.133557481833375 59.869321930619741, 30.097456377815117 59.867971876895524, 30.076744157623928 59.866825443442956))";

String orangePoly =
    "POLYGON ((29.998212698739131 60.003072270485404, 30.0055000021193 59.9983169749567, 30.020426236773819 59.998139754564704, 30.05796885784223 59.997952068026052, 30.092922764532052 59.990619173947046, 30.131395729449356 59.987542309379023, 30.131395729449356 59.991976787793583, 30.131470831301826 59.996088225968244, 30.129008139783068 59.99946932552956, 30.125687988665682 60.005620490515582, 30.114959152606218 60.007447103607191, 30.102513702777117 60.007672737014389, 30.096572814692788 60.021248067467511, 30.096994077417229 60.02565502312585, 30.101878535942273 60.029116509784366, 30.103399272368087 60.030616273442796, 30.105275439531287 60.031602335927687, 30.106979945317565 60.032416587842462, 30.12749044387397 60.043485930010249, 30.125728016862347 60.047370950618429, 30.124180166572007 60.051298433349977, 30.124732270251496 60.056469976875704, 30.140118691211544 60.058558471618781, 30.148498547199264 60.05962412420876, 30.152945967258585 60.061058018207447, 30.157221725940982 60.062298771487043, 30.161756997370706 60.063598412180568, 30.165605623292645 60.06597055916442, 30.171449148520821 60.068928799453296, 30.1748140503159 60.0714757843173, 30.181289904944968 60.076483386444544, 30.190252782636836 60.080696911101192, 30.193909708419593 60.081407157936432, 30.197223311448504 60.0823317914216, 30.201974622756804 60.083097185048153, 30.206923171322181 60.083770437123796, 30.209300886080278 60.084096338497467, 30.211914635232073 60.08421856775513, 30.216466216863271 60.0844683845861, 30.218312854236551 60.084582572960961, 30.221017798494668 60.085211282973958, 30.230485742183362 60.087222238486973, 30.238709140889146 60.08979039245672, 30.244384751619148 60.092012802958934, 30.25026429842249 60.094659691082121, 30.256658829356724 60.09649200225752, 30.262710037537062 60.098195632781511, 30.271293251027288 60.098999158685039, 30.275359382545584 60.099533795992876, 30.279597175440855 60.099554135273706, 30.288759406739359 60.099294808333717, 30.294660071875423 60.098649750952781, 30.304251456616218 60.097361777572544, 30.317812316002481 60.095873180984839, 30.33215667246559 60.095188482556452, 30.346672690306104 60.094932410794769, 30.35457442938986 60.094400398431006, 30.358224891522092 60.094027226707553, 30.361532030900282 60.093225393155087, 30.364078912098645 60.092723099216443, 30.366883285362352 60.092242231274291, 30.372234539824323 60.091023261791392, 30.382250403240807 60.088070717934805, 30.38409703619396 60.087421983495823, 30.389119404620796 60.086430238788509, 30.396503390131475 60.085089815718412, 30.412558821480054 60.083480791923904, 30.421702336104637 60.082554118848044, 30.430588358663748 60.081155723337488, 30.439388550534307 60.079672377998378, 30.459667323837735 60.076017505425433, 30.477048378782328 60.0726505547253, 30.482246542419009 60.071642552433246, 30.484183139893556 60.070934786518741, 30.492219123234442 60.068618360165104, 30.49371051657867 60.067771102936547, 30.498291814708036 60.064993250950394, 30.498770459338335 60.0607136508361, 30.490512543494305 60.053702853800871, 30.455132130091584 60.03411061839406, 30.473904012560524 60.021096267277024, 30.498518675603226 60.00468140502403, 30.496138235742084 60.000983366449248, 30.496161055158321 59.999402161238777, 30.496356897695534 59.996895153238789, 30.502456323553758 59.992117054767554, 30.499176023207653 59.98583661515044, 30.501612830737244 59.983061531641106, 30.511843456792047 59.982147025938481, 30.521215775962169 59.980544293812187, 30.533780604732012 59.977184686361923, 30.539719696363 59.975504754360379, 30.544800481109256 59.973394516286866, 30.548980043626493 59.971040034373132, 30.552043807193552 59.96872841295292, 30.567176795441828 59.965396276295728, 30.578734416580108 59.964655319967193, 30.58442739646075 59.962649495016777, 30.570815851885694 59.926444508700065, 30.559559457746289 59.903690688022053, 30.550019677376426 59.89161890639847, 30.546454560317411 59.887349397560342, 30.549232542984956 59.874244846969283, 30.539822567888947 59.859926369056573, 30.521314539814391 59.850395317002935, 30.538512078145978 59.842200542877585, 30.531494538335227 59.835100651823559, 30.525421136097684 59.828906675503433, 30.523242741863697 59.826371038670565, 30.520377702121873 59.825823137673162, 30.513564450710177 59.825188796965286, 30.50623621516764 59.824208712599592, 30.50127133615257 59.823677373219454, 30.496821441268388 59.822800279150449, 30.488093312876995 59.822429057746881, 30.47080871747113 59.822378114488984, 30.447945127314277 59.819517809804935, 30.419073388964065 59.811858771195936, 30.426972218557975 59.80781533309456, 30.420385314780884 59.805745016482206, 30.403831021522688 59.798417496642287, 30.393370707146421 59.803890787105665, 30.385914222319315 59.802125080782069, 30.379138990464849 59.801501670778, 30.372449589298853 59.800445775968896, 30.343084953316968 59.796735868487936, 30.334335737901192 59.8046189806793, 30.320185092489734 59.80383131482828, 30.307064415339976 59.805984106660112, 30.292656277863149 59.809693275584912, 30.281203590045077 59.813752521990835, 30.275486547698705 59.812713817245722, 30.262388066143405 59.8194993276728, 30.253924441765811 59.816256297950659, 30.24700576978076 59.822133490379123, 30.214756267287843 59.813902205178124, 30.210856680055798 59.816318354335891, 30.204357859950495 59.813506160855859, 30.195799103321804 59.811212536309228, 30.188012822889323 59.810129355172286, 30.182286478980352 59.808527297881334, 30.178607915485333 59.80627773169239, 30.1756159974981 59.803941527217162, 30.172709910199337 59.801778142370971, 30.168945516015846 59.8002200926292, 30.156483607356602 59.798995433473792, 30.149222684765267 59.800588777928553, 30.142648407681765 59.803133429737166, 30.11875455862506 59.811580809477228, 30.103787101169853 59.816481639405495, 30.089162966468642 59.822246141943658, 30.071463725640644 59.828669060699838, 30.069214008738545 59.837682785787131, 30.067123075759831 59.846953186499654, 30.065790860157204 59.851582419037229, 30.076474940941289 59.866916677894174, 30.062824181611106 59.872889437095175, 29.967838472620851 59.881871184011928, 29.952074726466503 59.852579594913095, 29.933391296501529 59.814235117545309, 29.950163114890671 59.800283851854061, 29.950944309979214 59.799191826850368, 29.953184626771925 59.798272768116483, 29.948395624196714 59.796207496325252, 29.942949369349574 59.793844711273479, 29.932298171044454 59.7892907433899, 29.930038726937166 59.787034159583804, 29.929538811943679 59.784333922855872, 29.929360762031905 59.782801792294663, 29.930002895061779 59.781888674021396, 29.931760827041856 59.780910621239435, 29.931963077793284 59.779640436973494, 29.931478683036929 59.778391842369011, 29.980955978476786 59.775854201549755, 30.034993637152315 59.765783404707, 30.047982584355523 59.765564985640488, 30.057923643697062 59.766238510465953, 30.073685889333294 59.771362199757291, 30.084957324346192 59.775706948438447, 30.090507211164155 59.778095494090238, 30.096915404866952 59.778839432023609, 30.107143064206834 59.776640540830165, 30.111190913976518 59.774701191854717, 30.117556192335 59.762350391826843, 30.141774253896681 59.761081348110388, 30.159991817525853 59.762823061982878, 30.173851161783688 59.766114237167905, 30.190393871021978 59.769144957780377, 30.200756770689992 59.774426113888289, 30.248044856178403 59.766030054040513, 30.32133501641302 59.741260806702655, 30.329197508966434 59.742577868354644, 30.335686710504273 59.745281126369143, 30.364733421440651 59.7464767998739, 30.389917751395608 59.7531887408624, 30.393681828574309 59.757774824869983, 30.414440382071348 59.755432012871665, 30.451589636218706 59.764570905947934, 30.48152911253403 59.777342811838167, 30.491554388011206 59.7826673124328, 30.494713208410296 59.787471791059581, 30.511296701676514 59.789295947961733, 30.550599035810485 59.794018615617752, 30.571366001827766 59.805591285577343, 30.57737008942701 59.804103156479407, 30.588933228943564 59.808260324644849, 30.5939290958798 59.817073474406229, 30.594067239559436 59.818002819392987, 30.603985382901925 59.825577091825856, 30.609459438704011 59.829709258019513, 30.612186912474925 59.833840909906641, 30.623450547979225 59.84349123855322, 30.66255633423722 59.851251819810848, 30.669406285471695 59.8575492204024, 30.671449718151543 59.86419074391727, 30.659566072532666 59.8786422042759, 30.651458977206843 59.893087363515932, 30.649417659314391 59.899338798593, 30.648388105792286 59.902433586391517, 30.64399300331624 59.9081050089896, 30.648857467894796 59.911242080508416, 30.649258736672589 59.914896041527506, 30.6488596445895 59.918152134093162, 30.645283041970856 59.92091929723933, 30.647498191587996 59.930244060907185, 30.642325947903647 59.935642274012842, 30.640664707963872 59.937339703285446, 30.641986741006132 59.937574657367527, 30.639878350238714 59.943806384330173, 30.640946441545136 59.956028394470842, 30.644737289463713 59.962087515661239, 30.6411788902983 59.966485348141674, 30.642941993818486 59.969161525520647, 30.6414900209272 59.973136532636083, 30.638586075144659 59.980913061128895, 30.631605149192097 59.985175412060265, 30.626741350265448 59.9951602890846, 30.615130718425405 59.994948173659644, 30.606652906714764 59.995015520031, 30.592400949980544 59.998009187754683, 30.595714486354829 60.004479928332678, 30.586300204322733 60.008049911591172, 30.583530394116696 60.00908671913848, 30.579597323646261 60.010854051623546, 30.580985755861423 60.011933743082857, 30.582998841031763 60.012470889843719, 30.575215795316314 60.049405567599543, 30.553221775980177 60.076914270602153, 30.474277051375349 60.099599872393355, 30.446830739856328 60.1017915784335, 30.431701132133902 60.107561085201731, 30.430304434567656 60.110587716378731, 30.422646899721361 60.110761801288469, 30.419109237922235 60.11500571080618, 30.407280144250926 60.117128905669226, 30.404907967650157 60.120004317123581, 30.390606104137259 60.12050367682513, 30.384372325341182 60.120703219080596, 30.376367183231505 60.12043496646023, 30.36904868662964 60.1213231249111, 30.365054698796669 60.120358324175015, 30.355521770738466 60.11868563544693, 30.353456112577792 60.122837903314576, 30.353793713694415 60.126904001665146, 30.349032077488246 60.126653477766638, 30.346908751450734 60.126463981172023, 30.34547207092098 60.126017545082647, 30.340669486375074 60.1254308339548, 30.337240192844689 60.125957537420305, 30.333467576560537 60.125970356883826, 30.331938360202727 60.128162726374441, 30.324915979782531 60.12992677078141, 30.320983504147424 60.127237571605107, 30.299458722792291 60.12624338914177, 30.282397137237869 60.125377649024081, 30.274133197252155 60.125261318535593, 30.267585871036342 60.1242884889414, 30.261628662306215 60.123430459874712, 30.25584311495339 60.124542425038754, 30.242074659900833 60.12069621927126, 30.23791924195751 60.119376742365269, 30.232612480167603 60.118579497815816, 30.226962395623776 60.118510403594883, 30.224223184040362 60.11839019015288, 30.222857263472548 60.117327629026256, 30.212273221684008 60.116237366773504, 30.207083169748184 60.117135161683173, 30.197429922011345 60.117304751725129, 30.186746706013004 60.117452923693094, 30.176750135522294 60.118971761567167, 30.173236486728708 60.113761275007249, 30.113906642161428 60.103059991767992, 30.082214279283832 60.081036335303835, 30.060204742659753 60.063707262443451, 30.0323585700326 60.051714124880206, 30.018890798122033 60.042294265514492, 30.015593962795904 60.039248392080815, 30.011146059355582 60.035947068125154, 29.998645363559234 60.028269674784973, 29.987173551586459 60.032312146197505, 29.984603687692509 60.030467582935636, 29.986537406563372 60.029362728289968, 29.985123728583805 60.027420285320161, 29.992915133079642 60.023877768282048, 29.992102011055643 60.022525815172685, 29.991720311990278 60.0207024476904, 29.991124036204035 60.019072312333932, 29.990613591106037 60.017828778210379, 29.99530951975985 60.016592427638862, 29.992722219499331 60.013095332182623, 29.991686061434542 60.012463920568656, 29.990309675517214 60.01030037057275, 29.983311379505036 60.007169680918395, 29.998212698739131 60.003072270485404))";

void main() {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({Key? key}) : super(key: key);

  // This widget is the root of your application.
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Flutter Demo',
      theme: ThemeData(
        // This is the theme of your application.
        //
        // Try running your application with "flutter run". You'll see the
        // application has a blue toolbar. Then, without quitting the app, try
        // changing the primarySwatch below to Colors.green and then invoke
        // "hot reload" (press "r" in the console where you ran "flutter run",
        // or simply save your changes to "hot reload" in a Flutter IDE).
        // Notice that the counter didn't reset back to zero; the application
        // is not restarted.
        primarySwatch: Colors.blue,
      ),
      home: const MapSearchScreen(),
    );
  }
}

class MapSearchScreen extends StatefulWidget {
  const MapSearchScreen({Key? key}) : super(key: key);

  @override
  State<MapSearchScreen> createState() => _MapSearchScreenState();
}

class _MapSearchScreenState extends State<MapSearchScreen> {
  late YandexMapController _controller;
  Future<LocationPermission> geoSettings = Geolocator.checkPermission();

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Row(children: [
          TextButton(onPressed: () {}, child: Text('Самовывоз')),
          TextButton(onPressed: () {}, child: Text('Курьером')),
        ]),
      ),
      body: YandexMap(
        onCameraPositionChanged: (cameraPosition, reason, finished) {},
        onMapCreated: (controller) async {
          _controller = controller;
          final cameraPosition = await controller.getCameraPosition();
          await controller.moveCamera(CameraUpdate.newCameraPosition(
              CameraPosition(
                  target: Point(latitude: 59.9311, longitude: 30.3609),
                  zoom: 10)));
        },
        mapObjects: [
          PlacemarkMapObject(
              opacity: 1,
              icon: PlacemarkIcon.single(PlacemarkIconStyle(
                  image:
                      BitmapDescriptor.fromAssetImage('assets/3.0x/Pin.png'))),
              mapId: MapObjectId('placemark'),
              point: Point(latitude: 59.945933, longitude: 30.320045)),
          PolygonMapObject(
            mapId: MapObjectId('polygon'),
            polygon: Polygon(
                outerRing: LinearRing(points: [
                  Point(
                      longitude: 30.217959676513523,
                      latitude: 59.941879441724176),
                  Point(
                      longitude: 30.24285057617173,
                      latitude: 59.925597462231714),
                  Point(
                      longitude: 30.286624227294787,
                      latitude: 59.94213782118819),
                  Point(
                      longitude: 30.243708883056513,
                      latitude: 59.95445156591633),
                  Point(
                      longitude: 30.217959676513523,
                      latitude: 59.941879441724176),
                ]),
                innerRings: []),
            strokeColor: Colors.orange[700]!,
            strokeWidth: 3.0,
            fillColor: Color(0x1FFF0000),
            onTap: (PolygonMapObject self, Point point) =>
                print('Tapped me at $point'),
          ),
        ],
      ),
      floatingActionButton: FutureBuilder<LocationPermission>(
          future: geoSettings,
          builder: (context, snapshot) {
            return (LocationPermission.always == snapshot.data ||
                    LocationPermission.whileInUse == snapshot.data)
                ? FloatingActionButton(
                    onPressed: () {
                      print('wtf');
                    },
                  )
                : FloatingActionButton(
                    child: const Icon(Icons.add),
                    onPressed: () {
                      setState(() {
                        geoSettings = Geolocator.requestPermission();
                      });
                    },
                  );
          }),
    );
  }
}
